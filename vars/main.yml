---
# Role variables

# Supported distributions

mysql_jdbc_connector_supported_distributions:
  - centos
  - fedora
  - rhel

# Supported distributions versions

mysql_jdbc_connector_supported_versions:
  centos: 6
  fedora: 27
  rhel: 6

# Effective version to deploy

mysql_jdbc_connector_effective_version: >-
  {{ (mysql_jdbc_connector_version == "latest")
     | ternary(mysql_jdbc_connector_latest_version,
               mysql_jdbc_connector_version) }}

# Paths

mysql_jdbc_connector_filename: >-
  mysql-connector-java-{{ mysql_jdbc_connector_effective_version }}

mysql_jdbc_connector_jar_filename: "{{ mysql_jdbc_connector_filename }}.jar"

mysql_jdbc_connector_tarball_filename: >-
  {{ mysql_jdbc_connector_filename + ".tar.gz" }}

mysql_jdbc_connector_unarchive_dir: >-
  {{ mysql_jdbc_connector_package
     | dirname
     + "/"
     + mysql_jdbc_connector_tarball_filename | regex_replace(".tar.gz", "") }}

# Connector urls

mysql_jdbc_connector_download_mirror: >-
  {{ (mysql_jdbc_connector_effective_version
      is version(mysql_jdbc_connector_latest_version, "=="))
     | ternary(mysql_jdbc_connector_latest_mirror,
               mysql_jdbc_connector_archive_mirror) }}

mysql_jdbc_connector_download_url: >-
  {{ mysql_jdbc_connector_download_mirror
     + "/"
     + mysql_jdbc_connector_tarball_filename }}

mysql_jdbc_connector_site: >-
  https://dev.mysql.com/downloads/connector/j

mysql_jdbc_connector_latest_mirror: >-
  https://dev.mysql.com/get/Downloads/Connector-J

mysql_jdbc_connector_archive_mirror: >-
  https://downloads.mysql.com/archives/get/file

mysql_jdbc_connector_official_download_host: >-
  https://{{ mysql_jdbc_connector_download_url | urlsplit('hostname') }}

mysql_jdbc_connector_official_download_path: >-
  {{ mysql_jdbc_connector_download_url | urlsplit('path') | dirname }}

mysql_jdbc_connector_official_download_file: >-
  {{ mysql_jdbc_connector_download_url | urlsplit('path') | basename }}

# Redistributable package

mysql_jdbc_connector_package: >-
  {{ lookup('vars',
            'artifact_result_'
            + mysql_jdbc_connector_artifact.id,
            default='')['download_path'] | default('') }}
